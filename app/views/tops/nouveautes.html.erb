<section id="main" class="category-page">
    <div class="full-width fw-border-bottom">
        <div class="container">
            <div class="row">
                <div class="col-md-12 col-sm-12">
                    <div class="title"><h3>Les nouveaut√©s clips</h3></div>
                    <div class="cd-gallery-container">
                        <nav class="cd-filter">
                            <ul>
                                <li class="placeholder"><a data-type="All" href="#0">All</a></li>
                                <li><a data-type="Zouk" href="#0">Zouk</a></li>
                                <li><a data-type="Rap, Hip-Hop et RnB" href="#0">Rap, Hip-Hop, RnB</a></li>
                                <li><a data-type="Traditionnel" href="#0">Traditionnel</a></li>
                                <li><a data-type="Dancehall" href="#0">Dancehall</a></li>
                                <li><a data-type="Reggae" href="#0">Reggae</a></li>
                                <li><a data-type="Soca et Bouyon" href="#0">Soca et Bouyon</a></li>
                                <li><a data-type="Pop" href="#0">Pop</a></li>
                            </ul>
                        </nav>

                        <ul class="cd-gallery cd-container">
                            
 
                                                                                <%=render collection: @clips, as: :clip, partial: "tops/myclip"%>
                                                                        </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<style>
    .label-primary {
        font-size: 1.2em;
    }
    .cd-filter {
        position: relative;
        height: 40px;
        width: 100%;
        margin: 0 auto;
        cursor: pointer;
        z-index: 10;
    }
    .cd-filter::after {
        /* small arrow icon */
        content: '';
        position: absolute;
        right: 14px;
        top: 50%;
        bottom: auto;
        -webkit-transform: translateY(-50%);
        -moz-transform: translateY(-50%);
        -ms-transform: translateY(-50%);
        -o-transform: translateY(-50%);
        transform: translateY(-50%);
        display: inline-block;
        width: 16px;
        height: 16px;
        background: url("../img/icon-small-arrow.svg") no-repeat center center;
        -webkit-transition: all 0.3s;
        -moz-transition: all 0.3s;
        transition: all 0.3s;
        pointer-events: none;
    }
    .cd-filter ul {
        list-style: none;
        position: absolute;
        padding: 0;
        width: 100%;
        top: 0;
        left: 0;
        background: #FFF;
        border-radius: 0.25em;
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }
    .cd-filter li {
        display: none;
        background: #fff;
    }
    .cd-filter li:first-child {
        display: block;
    }
    .cd-filter li:last-child a {
        border-radius: 0 0 .25em .25em;
    }
    .cd-filter a {
        display: block;
        height: 40px;
        /*width: 150px;*/
        line-height: 40px;
        padding-left: 14px;
        font-size: 14px;
        color: #000;
        font-size: 0.875rem;
        font-weight: 400;
        text-transform: uppercase;
    }
    .cd-filter a.selected {
        background: #00caeb;
        color: #FFF;
    }
    .no-touch .cd-filter a.selected:hover {
        background: #00caeb;
    }
    .cd-filter.is-open::after {
        -webkit-transform: translateY(-50%) rotate(-180deg);
        -moz-transform: translateY(-50%) rotate(-180deg);
        -ms-transform: translateY(-50%) rotate(-180deg);
        -o-transform: translateY(-50%) rotate(-180deg);
        transform: translateY(-50%) rotate(-180deg);
        /* small arrow rotation */
    }
    .cd-filter.is-open ul li {
        display: block;
    }
    .cd-filter.is-open .placeholder a {
        opacity: .4;
    }
    @media only screen and (min-width: 768px) {
        .cd-filter {
            height: auto;
            width: auto;
        }
        .cd-filter::after {
            display: none;
        }
        .cd-filter ul {
            background: transparent;
            position: static;
            box-shadow: none;
            text-align: center;
        }
        .cd-filter li {
            display: inline-block;
            margin: 0 .4em;
        }
        .cd-filter li:first-child {
            display: inline-block;
        }
        .cd-filter li.placeholder {
            display: none !important;
        }
        .cd-filter li.placeholder a {
            display: none;
        }
        .cd-filter a {
            display: inline-block;
            padding: 1em 2em;
            color: #000;
            height: auto;
            width: auto;
            line-height: 1;
            border-radius: 50em !important;
        }
        .no-touch .cd-filter a:hover {
            box-shadow: inset 0 0 0 2px rgba(56, 56, 56, 0.2);
        }
        .cd-filter a.selected:hover {
            box-shadow: none;
            /* removes the hover effect from the selected item */
        }
        .cd-filter.is-open ul li {
            display: inline-block;
        }
    }

    /* --------------------------------

    xgallery

    -------------------------------- */
    .cd-gallery {
        margin-top: 2em;
        position: relative;
        list-style: none;
        padding: 0;
        z-index: 5;
    }
    .cd-gallery > li {
        position: relative;
        margin-bottom: 1em;
    }
    .cd-gallery .cd-item-wrapper {
        /* this is the item that rotates */
        list-style: none;
        padding: 0;
        position: relative;
    }
    .touch .cd-gallery .cd-item-wrapper {
        /* fix a bug on IOS8 - rotating elements dissapear*/
        -webkit-perspective: 800px;
        -moz-perspective: 800px;
        perspective: 800px;
    }
    .cd-gallery .cd-item-wrapper.is-switched .is-visible {
        -webkit-transform: rotateY(180deg);
        -moz-transform: rotateY(180deg);
        -ms-transform: rotateY(180deg);
        -o-transform: rotateY(180deg);
        transform: rotateY(180deg);
        -webkit-animation: cd-rotate 0.5s;
        -moz-animation: cd-rotate 0.5s;
        animation: cd-rotate 0.5s;
    }
    .cd-gallery .cd-item-wrapper.is-switched .is-hidden {
        -webkit-transform: rotateY(0);
        -moz-transform: rotateY(0);
        -ms-transform: rotateY(0);
        -o-transform: rotateY(0);
        transform: rotateY(0);
        -webkit-animation: cd-rotate-inverse 0.5s;
        -moz-animation: cd-rotate-inverse 0.5s;
        animation: cd-rotate-inverse 0.5s;
        opacity: 0;
    }
    .cd-gallery .cd-item-wrapper.is-switched .is-selected {
        opacity: 1;
    }
    .cd-gallery .cd-item-wrapper > li {
        -webkit-backface-visibility: hidden;
        backface-visibility: hidden;
        border-radius: 0.25em;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    .cd-gallery .cd-item-wrapper > li img {
        display: block;
        width: 100%;
        border-radius: 0.25em;
    }
    .cd-gallery li.is-visible {
        /* the front item, visible by default */
        position: relative;
        z-index: 5;
    }
    .cd-gallery li.is-hidden {
        /* the hidden items, right behind the front one */
        position: absolute;
        list-style: none;
        top: 0;
        left: 0;
        /*height: 100%;*/
        /*width: 100%;*/
        z-index: 1;
        -webkit-transform: rotateY(180deg);
        -moz-transform: rotateY(180deg);
        -ms-transform: rotateY(180deg);
        -o-transform: rotateY(180deg);
        transform: rotateY(180deg);
    }
    .cd-gallery li.is-selected {
        z-index: 3 !important;
    }

    /* --------------------------------

    xkeyframes

    -------------------------------- */
    @-webkit-keyframes cd-rotate {
        0% {
            -webkit-transform: perspective(800px) rotateY(0);
        }
        70% {
            -webkit-transform: perspective(800px) rotateY(200deg);
        }
        100% {
            -webkit-transform: perspective(800px) rotateY(180deg);
        }
    }
    @-moz-keyframes cd-rotate {
        0% {
            -moz-transform: perspective(800px) rotateY(0);
        }
        70% {
            -moz-transform: perspective(800px) rotateY(200deg);
        }
        100% {
            -moz-transform: perspective(800px) rotateY(180deg);
        }
    }
    @keyframes cd-rotate {
        0% {
            -webkit-transform: perspective(800px) rotateY(0);
            -moz-transform: perspective(800px) rotateY(0);
            -ms-transform: perspective(800px) rotateY(0);
            -o-transform: perspective(800px) rotateY(0);
            transform: perspective(800px) rotateY(0);
        }
        70% {
            -webkit-transform: perspective(800px) rotateY(200deg);
            -moz-transform: perspective(800px) rotateY(200deg);
            -ms-transform: perspective(800px) rotateY(200deg);
            -o-transform: perspective(800px) rotateY(200deg);
            transform: perspective(800px) rotateY(200deg);
            /* this creates the bounce effect */
        }
        100% {
            -webkit-transform: perspective(800px) rotateY(180deg);
            -moz-transform: perspective(800px) rotateY(180deg);
            -ms-transform: perspective(800px) rotateY(180deg);
            -o-transform: perspective(800px) rotateY(180deg);
            transform: perspective(800px) rotateY(180deg);
        }
    }
    @-webkit-keyframes cd-rotate-inverse {
        0% {
            -webkit-transform: perspective(800px) rotateY(-180deg);
        }
        70% {
            -webkit-transform: perspective(800px) rotateY(20deg);
            /* this creates the bounce effect */
        }
        100% {
            -webkit-transform: perspective(800px) rotateY(0);
        }
    }
    @-moz-keyframes cd-rotate-inverse {
        0% {
            -moz-transform: perspective(800px) rotateY(-180deg);
        }
        70% {
            -moz-transform: perspective(800px) rotateY(20deg);
            /* this creates the bounce effect */
        }
        100% {
            -moz-transform: perspective(800px) rotateY(0);
        }
    }
    @keyframes cd-rotate-inverse {
        0% {
            -webkit-transform: perspective(800px) rotateY(-180deg);
            -moz-transform: perspective(800px) rotateY(-180deg);
            -ms-transform: perspective(800px) rotateY(-180deg);
            -o-transform: perspective(800px) rotateY(-180deg);
            transform: perspective(800px) rotateY(-180deg);
        }
        70% {
            -webkit-transform: perspective(800px) rotateY(20deg);
            -moz-transform: perspective(800px) rotateY(20deg);
            -ms-transform: perspective(800px) rotateY(20deg);
            -o-transform: perspective(800px) rotateY(20deg);
            transform: perspective(800px) rotateY(20deg);
            /* this creates the bounce effect */
        }
        100% {
            -webkit-transform: perspective(800px) rotateY(0);
            -moz-transform: perspective(800px) rotateY(0);
            -ms-transform: perspective(800px) rotateY(0);
            -o-transform: perspective(800px) rotateY(0);
            transform: perspective(800px) rotateY(0);
        }
    }
</style>
<%=content_for :myjs do%>

<script>
    $(function(){
        //wrap each one of your filter in a .cd-gallery-container
        bouncy_filter($('.cd-gallery-container'));

        function bouncy_filter($container) {
            $container.each(function(){
                var $this = $(this);
                var filter_list_container = $this.children('.cd-filter'),
                    filter_values = filter_list_container.find('li:not(.placeholder) a'),
                    filter_list_placeholder = filter_list_container.find('.placeholder a'),
                    filter_list_placeholder_text = filter_list_placeholder.text(),
                    filter_list_placeholder_default_value = 'Select',
                    gallery_item_wrapper = $this.children('.cd-gallery').find('.cd-item-wrapper');

                //store gallery items
                var gallery_elements = {};
                filter_values.each(function(){
                    var filter_type = $(this).data('type');
                    gallery_elements[filter_type] = gallery_item_wrapper.find('li[data-type="'+filter_type+'"]');
                });

                //detect click event
function RecursiveUnbind($jElement) {
    // remove this element's and all of its children's click events
    $jElement.unbind();
    $jElement.removeAttr('onclick');
    $jElement.children().each(function () {
        RecursiveUnbind($(this));
    });
}
RecursiveUnbind(filter_list_container);


                filter_list_container.on('click', function(event){
                    event.preventDefault();

                    var selected_filter = $(event.target).data('type');
                    //check if user has clicked the placeholder item (for mobile version)
                    if( $(event.target).is(filter_list_placeholder) || $(event.target).is(filter_list_container) ) {

                        (filter_list_placeholder_default_value == filter_list_placeholder.text()) ? filter_list_placeholder.text(filter_list_placeholder_text) : filter_list_placeholder.text(filter_list_placeholder_default_value) ;
                        filter_list_container.toggleClass('is-open');
main.style.paddingBottom="100%";

                        //check if user has clicked a filter already selected
                    } else if( filter_list_placeholder.data('type') == selected_filter ) {

                        filter_list_placeholder.text($(event.target).text()) ;
                        filter_list_container.removeClass('is-open');
main.style.paddingBottom="100%";

                    } else {
main.style.paddingBottom="100%";
                        //close the dropdown (mobile version) and change placeholder text/data-type value
                        filter_list_container.removeClass('is-open');
                        filter_list_placeholder.text($(event.target).text()).data('type', selected_filter);
                        filter_list_placeholder_text = $(event.target).text();

                        //add class selected to the selected filter item
                        filter_values.removeClass('selected');
                        $(event.target).addClass('selected');

                        //give higher z-index to the gallery items selected by the filter
                        show_selected_items(gallery_elements[selected_filter]);

                        //rotate each item-wrapper of the gallery
                        //at the end of the animation hide the not-selected items in the gallery amd rotate back the item-wrappers

                        // fallback added for IE9
                        var is_explorer_9 = navigator.userAgent.indexOf('MSIE 9') > -1;
if (event.target.dataset.type === "All"){

                    $(".cd-gallery.cd-container li").show();
main.style.paddingTop="200px";
}else{
                    $(".cd-gallery.cd-container li").hide();
}


                        if( is_explorer_9 ) {
                            hide_not_selected_items(gallery_elements, selected_filter);
                            gallery_item_wrapper.removeClass('is-switched');
                    $("[data-type='"+event.target.dataset.type+"'].is-visible").show();
                        } else {
                            gallery_item_wrapper.addClass('is-switched').eq(0).one('webkitAnimationEnd oanimationend msAnimationEnd animationend', function() {
                                hide_not_selected_items(gallery_elements, selected_filter);
                                gallery_item_wrapper.removeClass('is-switched');
                            });

                    $(".cd-gallery.cd-container [data-type='"+event.target.dataset.type+"'].is-visible").show();
                        }
                    }



                });
            });
        }
    });

    function show_selected_items(selected_elements) {
        selected_elements.addClass('is-selected');
    }

    function hide_not_selected_items(gallery_containers, filter) {
        $.each(gallery_containers, function(key, value){
            if ( key != filter ) {
                $(this).removeClass('is-visible is-selected').addClass('is-hidden');

            } else {
                $(this).addClass('is-visible').removeClass('is-hidden is-selected');
            }
        });
    }
</script>
<%end%>
